<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–Ω–µ–≤–Ω–∏–∫ –¥–∞–≤–ª–µ–Ω–∏—è</title>
    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: Arial, sans-serif; 
            max-width: 500px; 
            margin: 0 auto; 
            padding: 20px;
            background: #f5f5f5;
        }
        .container { 
            background: white; 
            padding: 25px; 
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #2196F3; text-align: center; }
        .date-display { 
            background: #e3f2fd; 
            padding: 10px; 
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #555; }
        input, textarea { 
            width: 100%; 
            padding: 10px; 
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .button { 
            background: #2196F3; 
            color: white; 
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-top: 10px;
        }
        .button:hover { background: #1976D2; }
        .history-item {
            background: #f9f9f9;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #2196F3;
        }
        .tabs { 
            display: flex; 
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        .tab { 
            padding: 10px 20px; 
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        .tab.active { 
            border-bottom-color: #2196F3;
            color: #2196F3;
            font-weight: bold;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .export-btn { 
            background: #4CAF50; 
            margin-top: 20px;
        }
        .danger { 
            background: #ff4444; 
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
        }
        .normal { 
            background: #4CAF50; 
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä –î–Ω–µ–≤–Ω–∏–∫ –¥–∞–≤–ª–µ–Ω–∏—è</h1>
        
        <div class="date-display" id="currentDate"></div>
        
        <div class="tabs">
            <div class="tab active" onclick="showTab('input')">–í–≤–æ–¥</div>
            <div class="tab" onclick="showTab('history')">–ò—Å—Ç–æ—Ä–∏—è</div>
            <div class="tab" onclick="showTab('export')">–≠–∫—Å–ø–æ—Ä—Ç</div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –≤–≤–æ–¥–∞ -->
        <div id="tab-input" class="tab-content active">
            <div class="input-group">
                <label>–í–µ—Ä—Ö–Ω–µ–µ –¥–∞–≤–ª–µ–Ω–∏–µ (—Å–∏—Å—Ç–æ–ª–∞):</label>
                <input type="number" id="systolic" placeholder="120" min="50" max="250">
            </div>
            
            <div class="input-group">
                <label>–ù–∏–∂–Ω–µ–µ –¥–∞–≤–ª–µ–Ω–∏–µ (–¥–∏–∞—Å—Ç–æ–ª–∞):</label>
                <input type="number" id="diastolic" placeholder="80" min="30" max="150">
            </div>
            
            <div class="input-group">
                <label>–ü—É–ª—å—Å (—É–¥/–º–∏–Ω):</label>
                <input type="number" id="pulse" placeholder="75" min="30" max="200">
            </div>
            
            <div class="input-group">
                <label>–ó–∞–º–µ—Ç–∫–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
                <textarea id="notes" rows="3" placeholder="–°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ, –ª–µ–∫–∞—Ä—Å—Ç–≤–∞..."></textarea>
            </div>
            
            <button class="button" onclick="saveMeasurement()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ—Ä–µ–Ω–∏–µ</button>
            
            <div id="status" style="margin-top: 15px; text-align: center;"></div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ -->
        <div id="tab-history" class="tab-content">
            <div id="history-list"></div>
            <button class="button" onclick="clearAllData()" style="background: #ff4444;">üóë –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é</button>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
        <div id="tab-export" class="tab-content">
            <p>–í—ã–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤—Ä–∞—á—É:</p>
            <button class="button export-btn" onclick="exportToCSV()">üì• –°–∫–∞—á–∞—Ç—å CSV —Ñ–∞–π–ª</button>
            <button class="button export-btn" onclick="exportToText()">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ —Ç–µ–∫—Å—Ç</button>
            <button class="button export-btn" onclick="printData()">üñ® –†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å</button>
            
            <div id="export-result" style="margin-top: 20px; white-space: pre-wrap; background: #f0f0f0; padding: 10px; border-radius: 5px; display: none;"></div>
        </div>
    </div>

    <script>
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
        function updateDateTime() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            document.getElementById('currentDate').textContent = 
                `üìÖ ${now.toLocaleDateString('ru-RU', options)}`;
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é
            document.getElementById(`tab-${tabName}`).classList.add('active');
            document.querySelector(`.tab[onclick="showTab('${tabName}')"]`).classList.add('active');
            
            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–ª–∏ –∏—Å—Ç–æ—Ä–∏—é - –æ–±–Ω–æ–≤–∏—Ç—å
            if (tabName === 'history') {
                loadHistory();
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è
        function saveMeasurement() {
            const systolic = document.getElementById('systolic').value;
            const diastolic = document.getElementById('diastolic').value;
            const pulse = document.getElementById('pulse').value;
            const notes = document.getElementById('notes').value;
            
            if (!systolic || !diastolic || !pulse) {
                showStatus('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
                return;
            }
            
            // –ü–æ–ª—É—á–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
            let measurements = JSON.parse(localStorage.getItem('healthData') || '[]');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ
            const newMeasurement = {
                id: Date.now(),
                date: new Date().toLocaleString('ru-RU'),
                systolic: parseInt(systolic),
                diastolic: parseInt(diastolic),
                pulse: parseInt(pulse),
                notes: notes
            };
            
            measurements.unshift(newMeasurement); // –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º
            localStorage.setItem('healthData', JSON.stringify(measurements));
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
            document.getElementById('systolic').value = '';
            document.getElementById('diastolic').value = '';
            document.getElementById('pulse').value = '';
            document.getElementById('notes').value = '';
            
            showStatus('‚úÖ –ò–∑–º–µ—Ä–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!', 'success');
            
            // –ê–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—é —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
            setTimeout(() => showTab('history'), 1000);
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
        function loadHistory() {
            const measurements = JSON.parse(localStorage.getItem('healthData') || '[]');
            const historyList = document.getElementById('history-list');
            
            if (measurements.length === 0) {
                historyList.innerHTML = '<p style="text-align: center; color: #777;">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π</p>';
                return;
            }
            
            let html = `<p>–í—Å–µ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π: ${measurements.length}</p>`;
            
            measurements.forEach(measurement => {
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –¥–∞–≤–ª–µ–Ω–∏—è
                let pressureStatus = '';
                let statusClass = '';
                
                if (measurement.systolic > 140 || measurement.diastolic > 90) {
                    pressureStatus = '–ü–æ–≤—ã—à–µ–Ω–Ω–æ–µ';
                    statusClass = 'danger';
                } else if (measurement.systolic < 100 || measurement.diastolic < 60) {
                    pressureStatus = '–ü–æ–Ω–∏–∂–µ–Ω–Ω–æ–µ';
                    statusClass = 'danger';
                } else {
                    pressureStatus = '–ù–æ—Ä–º–∞';
                    statusClass = 'normal';
                }
                
                // –°—Ç–∞—Ç—É—Å –ø—É–ª—å—Å–∞
                let pulseStatus = '';
                if (measurement.pulse > 100) {
                    pulseStatus = '<span class="danger">–í—ã—Å–æ–∫–∏–π</span>';
                } else if (measurement.pulse < 60) {
                    pulseStatus = '<span class="danger">–ù–∏–∑–∫–∏–π</span>';
                } else {
                    pulseStatus = '<span class="normal">–ù–æ—Ä–º–∞</span>';
                }
                
                html += `
                    <div class="history-item">
                        <div style="font-weight: bold;">${measurement.date}</div>
                        <div>üìä –î–∞–≤–ª–µ–Ω–∏–µ: <b>${measurement.systolic}/${measurement.diastolic}</b> 
                            <span class="${statusClass}">${pressureStatus}</span>
                        </div>
                        <div>‚ù§Ô∏è –ü—É–ª—å—Å: <b>${measurement.pulse}</b> —É–¥/–º–∏–Ω ${pulseStatus}</div>
                        ${measurement.notes ? `<div>üìù –ó–∞–º–µ—Ç–∫–∏: ${measurement.notes}</div>` : ''}
                        <button onclick="deleteMeasurement(${measurement.id})" style="margin-top: 5px; background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">
                            –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                `;
            });
            
            historyList.innerHTML = html;
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è
        function deleteMeasurement(id) {
            let measurements = JSON.parse(localStorage.getItem('healthData') || '[]');
            measurements = measurements.filter(m => m.id !== id);
            localStorage.setItem('healthData', JSON.stringify(measurements));
            loadHistory();
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        function clearAllData() {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ—Ä–µ–Ω–∏–π? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                localStorage.removeItem('healthData');
                loadHistory();
                showStatus('–ò—Å—Ç–æ—Ä–∏—è –æ—á–∏—â–µ–Ω–∞', 'success');
            }
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
        function exportToCSV() {
            const measurements = JSON.parse(localStorage.getItem('healthData') || '[]');
            
            let csv = '–î–∞—Ç–∞;–í–µ—Ä—Ö–Ω–µ–µ –¥–∞–≤–ª–µ–Ω–∏–µ;–ù–∏–∂–Ω–µ–µ –¥–∞–≤–ª–µ–Ω–∏–µ;–ü—É–ª—å—Å;–ó–∞–º–µ—Ç–∫–∏\n';
            
            measurements.forEach(m => {
                csv += `"${m.date}";${m.systolic};${m.diastolic};${m.pulse};"${m.notes || ''}"\n`;
            });
            
            // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `–¥–∞–≤–ª–µ–Ω–∏–µ_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            
            showExportResult(`CSV —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω. –ó–∞–ø–∏—Å–µ–π: ${measurements.length}`);
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ç–µ–∫—Å—Ç
        function exportToText() {
            const measurements = JSON.parse(localStorage.getItem('healthData') || '[]');
            
            let text = '–î–ù–ï–í–ù–ò–ö –î–ê–í–õ–ï–ù–ò–Ø\n';
            text += `–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ: ${new Date().toLocaleString('ru-RU')}\n`;
            text += `–í—Å–µ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π: ${measurements.length}\n\n`;
            
            measurements.forEach(m => {
                text += `üìÖ ${m.date}\n`;
                text += `  –î–∞–≤–ª–µ–Ω–∏–µ: ${m.systolic}/${m.diastolic}\n`;
                text += `  –ü—É–ª—å—Å: ${m.pulse} —É–¥/–º–∏–Ω\n`;
                if (m.notes) text += `  –ó–∞–º–µ—Ç–∫–∏: ${m.notes}\n`;
                text += '‚îÄ'.repeat(30) + '\n';
            });
            
            // –ö–æ–ø–∏—Ä—É–µ–º –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
            navigator.clipboard.writeText(text).then(() => {
                showExportResult('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            });
        }
        
        // –ü–µ—á–∞—Ç—å
        function printData() {
            const measurements = JSON.parse(localStorage.getItem('healthData') || '[]');
            
            let printContent = `
                <html>
                <head><title>–î–Ω–µ–≤–Ω–∏–∫ –¥–∞–≤–ª–µ–Ω–∏—è</title></head>
                <body>
                <h1>–î–Ω–µ–≤–Ω–∏–∫ –∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è</h1>
                <p>–ü–∞—Ü–∏–µ–Ω—Ç: [–í–≤–µ–¥–∏—Ç–µ –∏–º—è]</p>
                <p>–ü–µ—Ä–∏–æ–¥: ${measurements.length > 0 ? 
                    `${measurements[measurements.length-1].date} - ${measurements[0].date}` : 
                    '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}</p>
                <table border="1" cellpadding="5" style="width:100%; border-collapse: collapse;">
                <tr><th>–î–∞—Ç–∞</th><th>–î–∞–≤–ª–µ–Ω–∏–µ</th><th>–ü—É–ª—å—Å</th><th>–ó–∞–º–µ—Ç–∫–∏</th></tr>
            `;
            
            measurements.forEach(m => {
                printContent += `
                    <tr>
                        <td>${m.date}</td>
                        <td>${m.systolic}/${m.diastolic}</td>
                        <td>${m.pulse}</td>
                        <td>${m.notes || ''}</td>
                    </tr>
                `;
            });
            
            printContent += '</table></body></html>';
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
        function showStatus(message, type) {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.style.color = type === 'error' ? '#ff4444' : '#4CAF50';
            setTimeout(() => { statusEl.textContent = ''; }, 3000);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞
        function showExportResult(message) {
            const resultEl = document.getElementById('export-result');
            resultEl.textContent = message;
            resultEl.style.display = 'block';
            setTimeout(() => { resultEl.style.display = 'none'; }, 5000);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateDateTime();
        setInterval(updateDateTime, 60000); // –û–±–Ω–æ–≤–ª—è—Ç—å –¥–∞—Ç—É –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            loadHistory();
        };
    </script>
</body>
</html>